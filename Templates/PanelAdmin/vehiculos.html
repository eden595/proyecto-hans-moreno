{% extends 'PanelAdmin/base_panel.html' %}
{% block title %}Veh铆culos - HansMoreno{% endblock %}
{% block menu_vehiculos %}active{% endblock %}

{% block content %}

<div class="page-header">
    <h1>Flota de Veh铆culos</h1>
    <p>Asignaci贸n de conductores y ubicaci贸n</p>
</div>

{% if messages %}
    {% for message in messages %}
        <div style="padding: 10px; background: #d4edda; color: #155724; margin-bottom: 15px; border-radius: 5px;">
            {{ message }}
        </div>
    {% endfor %}
{% endif %}

<div class="stats-grid">
    {% for vehiculo in vehiculos %}
    <div class="card stats-card" style="display: flex; flex-direction: column; gap: 10px;">
        <div class="card-header">
            <div style="font-weight: bold; font-size: 1.2em;">{{ vehiculo.patente }}</div>
            <div style="color: #666;">{{ vehiculo.modelo }}</div>
        </div>

        <!-- Simulaci贸n de Mapa / Ubicaci贸n -->
        <div style="background: #eee; height: 100px; display: flex; align-items: center; justify-content: center; border-radius: 5px; font-size: 0.9em; color: #555;">
             <a href="https://www.google.com/maps?q=-33.4489,-70.6693" target="_blank">Ver ubicaci贸n en tiempo real</a>
        </div>

        <hr style="border: 0; border-top: 1px solid #eee; width: 100%;">

        <!-- Formulario de Asignaci贸n -->
        <form method="post" style="display: flex; flex-direction: column; gap: 5px;">
            {% csrf_token %}
            <input type="hidden" name="id_vehiculo" value="{{ vehiculo.id_vehiculo }}">
            
            <label style="font-size: 0.8em; color: #888;">Conductor Asignado:</label>
            <select name="conductor_asignado" style="padding: 5px;">
                <option value="">-- Sin Asignar --</option>
                {% for c in conductores %}
                    <option value="{{ c.id_usuario }}" {% if vehiculo.conductor.id_usuario == c.id_usuario %}selected{% endif %}>
                        {{ c.nombre }}
                    </option>
                {% endfor %}
            </select>
            
            <button type="submit" class="btn-primary" style="margin-top: 5px; font-size: 0.9em;">Guardar Cambios</button>
        </form>
    </div>
    {% endfor %}
</div>
{% endblock %}